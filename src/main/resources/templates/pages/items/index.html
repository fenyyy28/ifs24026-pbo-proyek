<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" 
      layout:decorate="~{layout/main}">
<head>
    <title>Daftar Barang - MyInventory</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Poppins', sans-serif;
            /* TEMA LILAC: Background lembut ungu muda */
            background: linear-gradient(135deg, #F3E8FF 0%, #E9D5FF 100%);
            min-height: 100vh;
            padding: 2rem;
            overflow-x: hidden;
            color: #4B5563;
        }

        .container-custom {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /* HEADER */
        .page-header {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            padding: 2rem;
            border-radius: 24px;
            box-shadow: 0 10px 30px rgba(147, 51, 234, 0.1); /* Shadow ungu tipis */
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.6);
        }

        .header-content h1 {
            font-weight: 800;
            font-size: 2.2rem;
            /* TEMA LILAC: Gradasi Teks Judul */
            background: linear-gradient(135deg, #A855F7 0%, #7E22CE 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-content p { color: #7E7E7E; font-size: 1.05rem; }
        .header-actions { display: flex; gap: 1rem; align-items: center; }

        /* BUTTONS */
        .btn-gradient {
            /* TEMA LILAC: Tombol Utama */
            background: linear-gradient(135deg, #C084FC 0%, #9333EA 100%);
            color: white;
            border: none;
            padding: 12px 28px;
            border-radius: 16px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 8px 24px rgba(168, 85, 247, 0.35); /* Shadow ungu */
            transition: all 0.3s ease;
        }
        .btn-gradient:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 12px 32px rgba(168, 85, 247, 0.5); 
            color: white;
        }

        .btn-outline {
            background: white;
            /* TEMA LILAC: Tombol Outline */
            color: #9333EA;
            border: 2px solid #9333EA;
            padding: 12px 28px;
            border-radius: 16px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        .btn-outline:hover { 
            background: #9333EA; 
            color: white; 
            transform: translateY(-3px); 
            box-shadow: 0 8px 24px rgba(147, 51, 234, 0.25);
        }

        /* DEBUG INFO */
        .debug-info {
            background: rgba(255, 255, 255, 0.7);
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            color: #6B21A8; /* Teks ungu tua */
            font-weight: bold;
            border: 1px solid #E9D5FF;
        }

        /* GRID LAYOUT */
        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
            width: 100%;
        }

        /* CARD ITEM */
        .item-card {
            background: white;
            border-radius: 24px;
            overflow: hidden;
            border: 1px solid #F3F4F6;
            box-shadow: 0 10px 40px rgba(139, 92, 246, 0.05); /* Shadow sangat halus ungu */
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .item-card:hover {
            transform: translateY(-10px);
            border-color: #E9D5FF;
            box-shadow: 0 20px 60px rgba(139, 92, 246, 0.15);
        }

        /* IMAGE AREA */
        .item-image-wrapper {
            width: 100%;
            height: 240px;
            position: relative;
            overflow: hidden;
            background: #FAF5FF; /* Latar ungu sangat muda jika gambar loading */
        }

        .item-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s ease;
        }
        
        .item-card:hover .item-image { transform: scale(1.1); }

        /* BADGES */
        .badge-qty {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(255, 255, 255, 0.95);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #9333EA; /* Ungu */
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            z-index: 2;
        }

        .badge-cond {
            position: absolute;
            top: 16px;
            left: 16px;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 2;
        }
        .bg-baik { background: #10b981; } /* Tetap Hijau (Semantik) */
        .bg-rusak { background: #ef4444; } /* Tetap Merah (Semantik) */
        .bg-baru { background: #A855F7; }  /* Ubah Biru jadi Ungu Cerah */
        .bg-default { background: #9CA3AF; }

        /* CONTENT */
        .item-content {
            padding: 1.5rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .item-category {
            font-size: 0.75rem;
            text-transform: uppercase;
            font-weight: 700;
            color: #A855F7; /* Label Kategori Ungu */
            margin-bottom: 0.5rem;
            letter-spacing: 0.5px;
            background: #F3E8FF;
            display: inline-block;
            padding: 4px 10px;
            border-radius: 8px;
            width: fit-content;
        }

        .item-name {
            font-size: 1.4rem;
            font-weight: 700;
            color: #4C1D95; /* Ungu Gelap Hampir Hitam */
            margin-bottom: 0.5rem;
            line-height: 1.3;
        }

        .item-price {
            font-size: 1.6rem;
            font-weight: 800;
            color: #7E22CE; /* Ungu Tua untuk Harga */
            margin-bottom: 1rem;
        }

        .item-info-row {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #6B7280;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        
        .item-info-row i { width: 20px; color: #C084FC; text-align: center; } /* Ikon Ungu Muda */

        /* ACTION BUTTONS */
        .item-actions {
            margin-top: auto;
            padding-top: 1rem;
            border-top: 1px solid #F3E8FF;
            display: flex;
            gap: 10px;
        }

        .btn-action {
            flex: 1;
            padding: 10px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.2s;
        }

        /* Detail jadi Ungu Muda */
        .btn-detail { background: #F3E8FF; color: #7E22CE; }
        .btn-detail:hover { background: #9333EA; color: white; }

        /* Edit tetap Orange tapi lebih soft */
        .btn-edit { background: #FFEDD5; color: #EA580C; }
        .btn-edit:hover { background: #EA580C; color: white; }

        /* Delete tetap Merah tapi lebih soft */
        .btn-delete { background: #FEE2E2; color: #DC2626; }
        .btn-delete:hover { background: #DC2626; color: white; }

        /* EMPTY STATE */
        .empty-state {
            grid-column: 1 / -1;
            background: white;
            border-radius: 24px;
            padding: 4rem;
            text-align: center;
            box-shadow: 0 10px 40px rgba(139, 92, 246, 0.1);
        }
        
        @media (max-width: 768px) {
            .page-header { flex-direction: column; align-items: flex-start; }
            .header-actions { width: 100%; margin-top: 1rem; flex-direction: column; }
            .btn-gradient, .btn-outline { width: 100%; justify-content: center; }
            .items-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
<div layout:fragment="content">
    <div class="container-custom">
        
        <!-- Header -->
        <div class="page-header">
            <div class="header-content">
                <h1><i class="fas fa-boxes" style="color: #9333EA;"></i> Inventaris Barang</h1>
                <p>Kelola dan pantau semua aset pribadi Anda dengan nuansa baru</p>
            </div>
            <div class="header-actions">
                <a th:href="@{/items/chart}" class="btn-outline">
                    <i class="fas fa-chart-pie"></i> Statistik
                </a>
                <a th:href="@{/items/create}" class="btn-gradient">
                    <i class="fas fa-plus-circle"></i> Tambah Barang
                </a>
            </div>
        </div>

        <!-- Debug Info -->
        <div class="debug-info" th:if="${items != null}">
            <i class="fas fa-terminal"></i> Status: Memuat <span th:text="${#lists.size(items)}">0</span> barang.
        </div>

        <!-- Items Grid -->
        <div class="items-grid" th:if="${items != null and !#lists.isEmpty(items)}">
            
            <!-- EACH CARD -->
            <div class="item-card" th:each="item : ${items}">
                
                <!-- Image Wrapper -->
                <div class="item-image-wrapper">
                    <img th:src="${(item.imageUrl == null || #strings.isEmpty(item.imageUrl)) ? 'https://placehold.co/400x300/F3E8FF/9333EA?text=No+Image' : (item.imageUrl.startsWith('http') ? item.imageUrl : '/uploads/' + item.imageUrl)}" 
                         th:alt="${item.name}" 
                         class="item-image"
                         loading="lazy"
                         onerror="this.onerror=null; this.src='https://placehold.co/400x300/F3E8FF/9333EA?text=Image+Error'">
                    
                    <!-- Badge Kondisi -->
                    <span class="badge-cond" 
                          th:classappend="${item.itemCondition == 'Baik' ? 'bg-baik' : (item.itemCondition == 'Rusak' ? 'bg-rusak' : 'bg-baru')}"
                          th:text="${item.itemCondition}">
                        Kondisi
                    </span>
                    
                    <!-- Badge Quantity -->
                    <span class="badge-qty">
                        <i class="fas fa-cube"></i> <span th:text="${item.quantity}">1</span>
                    </span>
                </div>

                <!-- Content -->
                <div class="item-content">
                    <div class="item-category">
                        <span th:text="${item.category}">Kategori</span>
                    </div>
                    
                    <h3 class="item-name" th:text="${item.name}">Nama Barang</h3>

                    <div class="item-price" 
                         th:text="'Rp ' + ${#numbers.formatDecimal(item.price, 0, 'COMMA', 0, 'POINT')}">
                        Rp 0
                    </div>

                    <!-- Info Details -->
                    <div class="item-info-row">
                        <i class="fas fa-calendar-alt"></i>
                        <span th:text="${#temporals.format(item.updatedAt, 'dd MMM yyyy')}">Tanggal</span>
                    </div>

                    <div class="item-info-row" th:if="${item.storageLocation != null and item.storageLocation != ''}">
                        <i class="fas fa-map-marker-alt"></i>
                        <span th:text="${item.storageLocation}">Lokasi</span>
                    </div>

                    <!-- Actions -->
                    <div class="item-actions">
                        <a th:href="@{/items/detail/{id}(id=${item.id})}" class="btn-action btn-detail" title="Detail">
                            <i class="fas fa-eye"></i>
                        </a>
                        <a th:href="@{/items/edit/{id}(id=${item.id})}" class="btn-action btn-edit" title="Edit">
                            <i class="fas fa-pen"></i>
                        </a>
                        <form th:action="@{/items/delete/{id}(id=${item.id})}" 
                              method="post" 
                              style="flex: 1; margin: 0;" 
                              onsubmit="return confirm('Yakin ingin menghapus barang ini?');">
                            <button type="submit" class="btn-action btn-delete" style="width: 100%;" title="Hapus">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            <!-- END EACH CARD -->

        </div>

        <!-- Empty State -->
        <div class="empty-state" th:if="${items == null or #lists.isEmpty(items)}">
            <i class="fas fa-box-open" style="font-size: 5rem; color: #E9D5FF; margin-bottom: 1rem;"></i>
            <h3 style="color: #4C1D95;">Belum Ada Data Barang</h3>
            <p style="color:#7E22CE;">Mulai tambahkan barang pertama Anda sekarang!</p>
            <a th:href="@{/items/create}" class="btn-gradient" style="margin-top:1rem;">
                <i class="fas fa-plus-circle"></i> Tambah Barang Baru
            </a>
        </div>

    </div>
</div>
</body>
</html>